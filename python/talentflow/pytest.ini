[pytest]
DJANGO_SETTINGS_MODULE = talentflow.settings.testing
python_files = test_*.py *_test.py
python_classes = Test*
python_functions = test_*
addopts = -v --tb=short --strict-markers
testpaths = tests
asyncio_mode = auto
timeout = 30

markers =
    unit: Unit tests (fast, isolated)
    integration: Integration tests (require database)
    system: System tests (full stack)
    security: Security tests
    slow: Slow tests
    bug_a1: Tests for bug A1 (connection pool exhaustion)
    bug_a2: Tests for bug A2 (N+1 query)
    bug_a3: Tests for bug A3 (transaction race)
    bug_b1: Tests for bug B1 (timezone mismatch)
    bug_b2: Tests for bug B2 (chord callback)
    bug_b3: Tests for bug B3 (Redis connection leak)
    bug_c1: Tests for bug C1 (JWT race)
    bug_c2: Tests for bug C2 (OAuth state validation)
    bug_d1: Tests for bug D1 (settings import order)
    bug_d2: Tests for bug D2 (psycopg2 conflict)
    bug_e1: Tests for bug E1 (off-by-one matching)
    bug_e2: Tests for bug E2 (timezone-naive datetime)
    bug_f1: Tests for bug F1 (race condition in counter)
    bug_f2: Tests for bug F2 (data-dependent scoring)
    bug_f3: Tests for bug F3 (memory leak in cache)
    bug_f4: Tests for bug F4 (cascading auth bugs)
    bug_g1: Tests for bug G1 (naive datetime in tasks)
    bug_g2: Tests for bug G2 (locale-dependent formatting)
    bug_g3: Tests for bug G3 (unicode encoding loss)
    bug_g4: Tests for bug G4 (floating point comparison)
    bug_h1: Tests for bug H1 (deadlock in reports)
    bug_h2: Tests for bug H2 (race in deduplication)
    bug_h3: Tests for bug H3 (phantom reads)
    bug_i1: Tests for bug I1 (SQL injection)
    bug_i2: Tests for bug I2 (SSRF vulnerability)
    bug_s5: Tests for bug S5 (circular import)
    bug_s6: Tests for bug S6 (missing __init__.py)
    bug_s7: Tests for bug S7 (migration dependency)
    bug_s8: Tests for bug S8 (env var coercion)
    bug_s9: Tests for bug S9 (package conflicts)
    bug_s10: Tests for bug S10 (settings module path)

filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
